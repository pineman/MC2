% vim: ts=4 sts=4 sw=4
\documentclass[portuguese, a4paper]{article}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{babel}
\usepackage[margin=2.5cm]{geometry}
\usepackage{lmodern}

\usepackage{graphicx}
\graphicspath{ {imagens/} }
\usepackage{wrapfig,lipsum}
\usepackage{bold-extra}
\usepackage{epstopdf}
\usepackage{float}
\usepackage{scalerel}
\usepackage{enumerate}
\usepackage{indentfirst}
\usepackage{mathtools}
\usepackage{amsmath}
\allowdisplaybreaks
\usepackage{amssymb}
\usepackage{listings}
\usepackage{color}
\usepackage{textcomp}
\usepackage{caption}
\usepackage{hyperref}
\hypersetup{
	colorlinks,
	citecolor=black,
	filecolor=black,
	linkcolor=black,
	urlcolor=blue
}

\newcommand\showdiv[1]{\overline{\smash{\hstretch{.5}{)}\mkern-3.2mu\hstretch{.5}{)}}#1}}
\newcommand\ph[1]{\textcolor{white}{#1}}
\newcommand\tu[0]{\textunderscore}

\definecolor{dkgreen}{rgb}{0,0.6,0}
\definecolor{gray}{rgb}{0.5,0.5,0.5}
\definecolor{mauve}{rgb}{0.58,0,0.82}
\definecolor{mygreen}{RGB}{28,172,0} % color values Red, Green, Blue
\definecolor{mylilas}{RGB}{170,55,241}

% ----- Cabeçalho e rodapé -----
\usepackage{fancyhdr}
\pagestyle{fancy}
\fancyhf{}

\renewcommand{\headrulewidth}{1pt}
\renewcommand{\footrulewidth}{0.5pt}

\rhead{2º Trabalho Computacional}
\lhead{Matemática Computacional}
\rfoot{Página \thepage}
\lfoot{\small Engenharia Eletrotécnica e de Computadores - IST}

\usepackage{pdfpages}

\begin{document}
\includepdf[pages={1}]{capa/capa.pdf}

% Secções em números romanos.
\renewcommand{\thesection}{\Roman{section}}
% Subsubsecções no estilo (a), (b), ...
\renewcommand{\thesubsubsection}{(\alph{subsubsection})}

\tableofcontents
\newpage

\section{}
	\subsection{}
	\label{sec:I.1}
	\par
	Resposta no ficheiro \texttt{I/min\tu quad.m}, corrido pelo \emph{script} \texttt{I/1.m}, onde é possível alterar os pontos tabelados, os respetivos pesos e as funções de base.

	\subsection{}
	\par
	Para os dados tabelados:
	\begin{table}[H]
		\centering
		\begin{tabular}{c|c|c|c|c|c|c|c|c|c|c}
			\hline
			$1/e$	& 0.345	& 0.287	& 0.251	& 0.225	& 0.207	& 0.186	& 0.161	& 0.132	& 0.084	& 0.060	\\ \hline
			$s$		& 367	& 311	& 295	& 268	& 253	& 239	& 220	& 213	& 193	& 192	\\ \hline
			$d$		& 17	& 9		& 9		& 7		& 7		& 6		& 6		& 6		& 5		& 5		\\ \hline
		\end{tabular}
		\caption{Dados tabelados.}
	\end{table}

	\par
	Foram obtidas as três funções aproximadoras pedidas, através da função desenvolvida em \ref{sec:I.1}, pelos ficheiros \texttt{I/2\tu i.m}, \texttt{I/2\tu ii.m} e \texttt{I/2\tu iii.m}, corridos no \emph{script} \texttt{I/2.m}.

	\begin{figure}[H]
		\centering
		\includegraphics[width=0.80\linewidth]{I_fino}
		\captionsetup{width=0.80\linewidth}
		\caption{Diferentes funções aproximadoras dos pontos tabelados pelo critério dos mínimos quadrados clássico e ponderado.}
	\end{figure}

\newpage

\section{}
	\subsection{}
	\par
	Resposta no ficheiro \texttt{II/simpson.m}, corrido pelo \emph{script} \texttt{II/1.m}, onde é possível alterar o intervalo de integração, o número de subintervalos e a função a integrar.

	\subsection{}
	\subsubsection{}
	\par
	Correndo o programa \texttt{II/2.m}, obtém-se:
	$$F =  1480.56848008215$$

	\subsubsection{}
	\par
	Correndo o programa \texttt{II/2.m}, obtém-se:
	\begin{table}[H]
		\centering
		\begin{tabular}{|c|c|c|c|}
			\hline
			$n$	& $S_n$				& $|F - S_n|$		& $\frac{|F - S_n/2|}{|F - S_n|}$ \\ \hline
			2	& 1219.63999486000	& 260.92848522216	& -					\\ \hline
			4	& 1426.86928844946	& 53.69919163269	& 4.85907659480		\\ \hline
			8	& 1473.14779849473	& 7.42068158743		& 7.23642309672		\\ \hline
			16	& 1479.85678890922	& 0.71169117293		& 10.42682819413	\\ \hline
			32	& 1480.51545319880	& 0.05302688335		& 13.42132759730	\\ \hline
			64	& 1480.56497529815	& 0.00350478401		& 15.12985771736	\\ \hline
			128	& 1480.56825767195	& 0.00022241020		& 15.75819799559	\\ \hline
			256	& 1480.56846613061	& 0.00001395154		& 15.94162455869	\\ \hline
			512	& 1480.56847921284	& 0.00000086931		& 16.04897985126	\\ \hline
		\end{tabular}
		\caption{Comparação dos erros da regra de Simpson para vários valores de N.}
	\end{table}

	% TODO: comentar os erros
	% a majoração do erro depende de N quarticamente, por isso,
	% se N duplicar, o erro cai para 1/16.

\section{}
	\subsection{}
	\par %III- 1
	O programa desenvolvido tem o nome de \texttt{ponto\tu medio.m}. Recebe um intervalo
	$[a,b]$, uma função $f$ desenvolvida à parte, específica para cada problema de valor inicial, 
	uma condição inicial $y_\alpha$ e um número $n$ de subintervalos.

	\subsection{}
		\subsubsection{}
		\par %III- 2
		Primeiramente, verifiquemos que o valor de $S$ para o qual $I(S) = 0$ é menor que 200.
		\par
		Isto pode ser feito com facilidade: olhando para \frac{dI}{dS} conseguímos reparar que para valores
		de S inferiores a 300, tem valor com sinal constante. Logo, nesse intervalo, segundo o Teorema de Bolzano,
		há, no máximo, 1 zero. Como $[0, 200]$ \subset $[0, 300]$, em $[0, 200]$ a derivada de I em função de S também não muda de sinal.
		Verificamos que há pelo menos um zero nesse intervalo por I(S) ser uma função contínua e por I(1) < 0 e I(200) > 0, 
		implicitando uma passagem pelo eixo das abcissas. Impondo a condição de ter que haver no mínimo uma passagem e ter que haver no máximo uma passagem, 
		podemos concluir que há um único zero no intervalo $[0, 200]$.
		\par
		Dividindo a segunda equação pela primeira, obtemos:
		%já tinhas começado as tais continhas (1)
		% Equações

		\begin{equation} \label{di}
		\begin{split}
			\frac{dI}{dS} = -1 + \frac{300}{s} \Leftrightarrow \\
			dI = ( -1 + \frac{300}{s})ds \Leftrightarrow \\
			\frac{dI}{dt} dt = (-1 + \frac{300}{s} \frac{dS}{dt} dt

		\end{split}
		\end{equation}


		Expressando I(t) em função de S(t), chegamos à equação que
		%aqui aquela que é para concluir)

		Impondo as condições iniciais. 
		%isto mas menos cancerígeno:
		I(0) = -S(0) + 300* ln(S(0)) + c <=> c = bla bla bla


		O número máximo de crianças doentes num dado momento pode ser obtido
		atráves do máximo de $I(S)$. A sua derivada tem um único zero em S = 300, 
		logo, sendo maior que 0 para valores inferiores a 300 e menor que 0 para valores superiores.
		Temos, portanto, um máximo em S = 300, que é também o máximo de I(S) e que é
		o número de crianças suscetíveis quando o número de crianças infetadas é máximo.
		Substituindo na equação, obtemos:
		%Freitas... :) 

		\subsubsection{}
		\par
		Se a epidemia acabar quando o número de crianças infetadas for 0, então, teremos
		que ver quantas crianças estão suscetíveis neste ponto, pois essas nunca serão infetadas, pelo menos nesta
		epidemia. Especialmente por ser varicela, uma doença que só se costuma ter uma vez, 
		podemos ver que a transição de estados de uma criança 
		é otimamente descrita por este diagrama.
		%lembras-te daquele diagrama de estados?...consegues?xD
		
		Uma criança, tirando a paciente zero, começa no estado suscetível. Passa
		para o estado infetado quando é infetada e depois de recuperada fica no estado de recuperada até ao fim da 
		epidemia e provavelmente até ao fim da sua vida.
		
		%se não conseguires ou não te apetecer, é só preciso trocar algumas palavras
		
		Podia-se ter usado uma função que interpola polinómios já implementada.
		Em vez disso conseguímos um resultado igualmente satisfatório através de funções criadas por nós, pois
		quando o grupo foi avisado da existência e possibilidade de utilização de funções como $polynomial$ %era assim que se chamava, não era?
		já tinha tudo implementado.
		
		%consegues por + bonito:
		Quere-se um S tal que I(S) = 0 => S = I^-1(0).
		A interpolação inversa consiste em aproximar a função inversa através de polinómios.
		Ao fazer-se isto, espera-se depois conseguir encontrar uma aproximação para a imagem de I^-1(0), 
		que será o S que nós procuramos.
		\par
		Depois de utilizarmos as duas funções, concluímos que I^-1(0) ~= 70.
		
		\subsubsection{}
		\par
		c, a última pergunta.
		%isto é um comentário com várias linhas:  (:P)
		tenho aqui um flowchart bonitinho de como fizemos a coisa.
		Antes de me pisgar para o norte deixo uma fotografia de um 
		flowchar bonitinho e legível. Também ainda acabo decentemente 
		estes discursos todos e explico o flowchart.
		Também não me importava nada de comentar o gráfico que obtivemos
		Volto a pegar nisto la para as 22 de hoje. 
		

\end{document}
